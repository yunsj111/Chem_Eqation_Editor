import streamlit as st
import sys
import os
from pathlib import Path

# í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ë¥¼ Python íŒ¨ìŠ¤ì— ì¶”ê°€
project_root = Path(__file__).parent
sys.path.append(str(project_root))

# ì»´í¬ë„ŒíŠ¸ ì„í¬íŠ¸
from components.drawing import MoleculeDrawer, get_common_smarts_patterns, get_element_info
from components.patterns import SmartsGenerator, PatternMatcher

# í˜ì´ì§€ ì„¤ì •
st.set_page_config(
    page_title="SMARTS íŒ¨í„´ í¸ì§‘ê¸°",
    page_icon="ğŸ§ª",
    layout="wide",
    initial_sidebar_state="expanded"
)

# ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜
def create_sidebar():
    """ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜ ìƒì„±"""
    with st.sidebar:
        st.title("ğŸ§ª SMARTS í¸ì§‘ê¸°")
        st.markdown("---")

        # ë©”ì¸ ë„¤ë¹„ê²Œì´ì…˜
        page = st.selectbox(
            "í˜ì´ì§€ ì„ íƒ:",
            [
                "ğŸ  í™ˆ",
                "âœï¸ ë¶„ì ê·¸ë¦¬ê¸°",
                "ğŸ§¬ SMARTS ìƒì„±",
                "ğŸ” íŒ¨í„´ ë§¤ì¹­",
                "ğŸ”„ ë°°ì¹˜ ë§¤ì¹­",
                "ğŸ“š íŒ¨í„´ ë¼ì´ë¸ŒëŸ¬ë¦¬",
                "â„¹ï¸ ë„ì›€ë§"
            ]
        )

        st.markdown("---")

        # ë¹ ë¥¸ ì•¡ì„¸ìŠ¤
        st.subheader("ë¹ ë¥¸ ì•¡ì„¸ìŠ¤")

        # ìì£¼ ì‚¬ìš©í•˜ëŠ” íŒ¨í„´
        st.write("**ìì£¼ ì‚¬ìš©í•˜ëŠ” íŒ¨í„´:**")
        common_patterns = get_common_smarts_patterns()

        for name, pattern in list(common_patterns.items())[:5]:
            if st.button(f"{pattern}", key=f"quick_{name}", help=name):
                st.session_state['selected_pattern'] = pattern
                st.success(f"'{pattern}' ì„ íƒë¨")

        # ì„¸ì…˜ ì •ë³´
        st.markdown("---")
        st.subheader("ì„¸ì…˜ ì •ë³´")

        if 'molecule_data' in st.session_state:
            atom_count = len(st.session_state.molecule_data.get('atoms', []))
            bond_count = len(st.session_state.molecule_data.get('bonds', []))
            st.write(f"**ì›ì ìˆ˜:** {atom_count}")
            st.write(f"**ê²°í•© ìˆ˜:** {bond_count}")

        if 'selected_pattern' in st.session_state:
            st.write(f"**ì„ íƒëœ íŒ¨í„´:** `{st.session_state.selected_pattern}`")

        # ì„¸ì…˜ ì´ˆê¸°í™”
        if st.button("ğŸ”„ ì„¸ì…˜ ì´ˆê¸°í™”"):
            for key in list(st.session_state.keys()):
                del st.session_state[key]
            st.success("ì„¸ì…˜ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!")
            st.rerun()

    return page

def create_home_page():
    """í™ˆ í˜ì´ì§€"""
    st.title("ğŸ§ª SMARTS íŒ¨í„´ í¸ì§‘ê¸°")
    st.markdown("---")

    # ì†Œê°œ
    st.markdown("""
    ## í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‘‹

    ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ **SMARTS (SMiles ARbitrary Target Specification)** íŒ¨í„´ì„ 
    ì‹œê°ì ìœ¼ë¡œ í¸ì§‘í•˜ê³  í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” í†µí•© ë„êµ¬ì…ë‹ˆë‹¤.
    
    ### ğŸš€ ìƒˆë¡œìš´ JavaScript ê¸°ë°˜ ì¸í„°ë™í‹°ë¸Œ í¸ì§‘ê¸°
    
    ë§ˆìš°ìŠ¤ í´ë¦­ë§Œìœ¼ë¡œ ë¶„ìë¥¼ ê·¸ë¦¬ê³  í¸ì§‘í•  ìˆ˜ ìˆëŠ” ìƒˆë¡œìš´ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤!
    """)

    # ì£¼ìš” ê¸°ëŠ¥
    col1, col2 = st.columns(2)

    with col1:
        st.subheader("ğŸ¨ ì£¼ìš” ê¸°ëŠ¥")
        st.markdown("""
        - **ğŸ–±ï¸ ì¸í„°ë™í‹°ë¸Œ ë¶„ì ê·¸ë¦¬ê¸°**: ë§ˆìš°ìŠ¤ í´ë¦­ìœ¼ë¡œ ì§ê´€ì ì¸ ë¶„ì í¸ì§‘
        - **ğŸ”µ ì›ì ì¶”ê°€**: ì›í•˜ëŠ” ìœ„ì¹˜ì— í´ë¦­ìœ¼ë¡œ ì›ì ë°°ì¹˜
        - **ğŸ”— ê²°í•© ìƒì„±**: ë‘ ë²ˆì˜ í´ë¦­ìœ¼ë¡œ ì›ì ê°„ ê²°í•© ìƒì„±
        - **â¬Ÿ ë¯¸ë¦¬ ì •ì˜ëœ êµ¬ì¡°**: ë²¤ì  , ì‚¬ì´í´ë¡œí—¥ì‚° ë“± ì›í´ë¦­ ì¶”ê°€
        - **ğŸ§¬ SMARTS ìƒì„±**: ê·¸ë¦° ë¶„ìì—ì„œ ìë™ìœ¼ë¡œ SMARTS íŒ¨í„´ ìƒì„±
        - **ğŸ” íŒ¨í„´ ë§¤ì¹­**: SMARTS íŒ¨í„´ìœ¼ë¡œ ë¶„ì ê²€ìƒ‰
        - **ğŸ’¾ íŒŒì¼ ê´€ë¦¬**: JSON í˜•ì‹ìœ¼ë¡œ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸°
        """)

    with col2:
        st.subheader("ğŸš€ ì‹œì‘í•˜ê¸°")
        st.markdown("""
        1. **âœï¸ ë¶„ì ê·¸ë¦¬ê¸°** í˜ì´ì§€ë¡œ ì´ë™
        2. ìº”ë²„ìŠ¤ì—ì„œ ì›í•˜ëŠ” ìœ„ì¹˜ë¥¼ í´ë¦­í•˜ì—¬ ì›ì ì¶”ê°€
        3. ê²°í•© ëª¨ë“œë¡œ ì „í™˜í•˜ì—¬ ì›ìë“¤ì„ ì—°ê²°
        4. **ğŸ§¬ SMARTS ìƒì„±** í˜ì´ì§€ì—ì„œ íŒ¨í„´ í™•ì¸
        5. **ğŸ” íŒ¨í„´ ë§¤ì¹­**ì—ì„œ ë‹¤ë¥¸ ë¶„ìë“¤ê³¼ ë¹„êµ
        
        ### ğŸ¯ í¸ì§‘ ëª¨ë“œ
        - **ğŸ”µ ì›ì ëª¨ë“œ**: í´ë¦­ìœ¼ë¡œ ì›ì ì¶”ê°€
        - **ğŸ”— ê²°í•© ëª¨ë“œ**: ë‘ ì›ìë¥¼ í´ë¦­í•˜ì—¬ ê²°í•© ìƒì„±
        - **ğŸ‘† ì„ íƒ ëª¨ë“œ**: ì›ì ì„ íƒ ë° ì´ë™
        - **ğŸ—‘ï¸ ì‚­ì œ ëª¨ë“œ**: í´ë¦­í•˜ì—¬ ì›ì/ê²°í•© ì‚­ì œ
        """)

    # ì¸í„°í˜ì´ìŠ¤ ë¯¸ë¦¬ë³´ê¸°
    st.markdown("---")
    st.subheader("ğŸ–¥ï¸ ì¸í„°í˜ì´ìŠ¤ ë¯¸ë¦¬ë³´ê¸°")
    
    # í˜„ì¬ ì„¸ì…˜ ìƒíƒœ í™•ì¸
    if 'molecule_data' in st.session_state and st.session_state.molecule_data['atoms']:
        st.success("âœ… í˜„ì¬ ì„¸ì…˜ì— ë¶„ì ë°ì´í„°ê°€ ìˆìŠµë‹ˆë‹¤!")
        col1, col2, col3 = st.columns(3)
        
        with col1:
            atom_count = len(st.session_state.molecule_data['atoms'])
            st.metric("í˜„ì¬ ì›ì ìˆ˜", atom_count)
        
        with col2:
            bond_count = len(st.session_state.molecule_data['bonds'])
            st.metric("í˜„ì¬ ê²°í•© ìˆ˜", bond_count)
        
        with col3:
            elements = set(atom['element'] for atom in st.session_state.molecule_data['atoms'])
            st.metric("ì›ì†Œ ì¢…ë¥˜", len(elements))
            if elements:
                st.write(f"**ì›ì†Œë“¤**: {', '.join(sorted(elements))}")
    else:
        st.info("ğŸ¨ ì•„ì§ ë¶„ìê°€ ê·¸ë ¤ì§€ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. 'ë¶„ì ê·¸ë¦¬ê¸°' í˜ì´ì§€ì—ì„œ ì‹œì‘í•´ë³´ì„¸ìš”!")

    # ê¸°ëŠ¥ ì†Œê°œ
    st.markdown("---")
    st.subheader("ğŸ”§ ê³ ê¸‰ ê¸°ëŠ¥")

    tab1, tab2, tab3 = st.tabs(["ê¸°ë³¸ í¸ì§‘", "êµ¬ì¡° ë¼ì´ë¸ŒëŸ¬ë¦¬", "ë¶„ì„ ë„êµ¬"])

    with tab1:
        st.markdown("""
        ### ê¸°ë³¸ í¸ì§‘ ë„êµ¬
        
        **ì›ì†Œ ì§€ì›:**
        - ì£¼ìš” ì›ì†Œ: C, N, O, S, P
        - í• ë¡œê²: F, Cl, Br, I  
        - ê¸°íƒ€: H, ì™€ì¼ë“œì¹´ë“œ (*)
        
        **ê²°í•© íƒ€ì…:**
        - ë‹¨ì¼ ê²°í•© (â€”)
        - ì´ì¤‘ ê²°í•© (=)
        - ì‚¼ì¤‘ ê²°í•© (â‰¡)
        - ë°©í–¥ì¡± ê²°í•© (:)
        
        **í¸ì§‘ ê¸°ëŠ¥:**
        - ê²©ì ìŠ¤ëƒ… (50px ë‹¨ìœ„)
        - ì‹¤ì‹œê°„ ì›ì/ê²°í•© ì¹´ìš´í„°
        - ì‹¤í–‰ ì·¨ì†Œ ê¸°ëŠ¥
        """)

    with tab2:
        st.markdown("""
        ### ë¯¸ë¦¬ ì •ì˜ëœ êµ¬ì¡°
        
        **ê¸°ë³¸ ê³ ë¦¬:**
        - â¬Ÿ ë²¤ì   (ë°©í–¥ì¡±)
        - â¬¡ ì‚¬ì´í´ë¡œí—¥ì‚° (ì§€ë°©ì¡±)
        
        **ë³µì¡í•œ êµ¬ì¡°:**
        - ë‚˜í”„íƒˆë Œ
        - í”¼ë¦¬ë”˜
        - í‘¸ë€
        - ì´ë¯¸ë‹¤ì¡¸
        
        **ì‘ìš©ê¸°:**
        - í˜ë‹ê¸°
        - ë©”í‹¸ê¸°
        - ì¹´ë¥´ë³µì‹¤ê¸°
        """)

    with tab3:
        st.markdown("""
        ### ë¶„ì„ ë° ê²€ì¦ ë„êµ¬
        
        **ë¶„ì ì •ë³´:**
        - ì›ì†Œë³„ ê°œìˆ˜ í†µê³„
        - ê²°í•© íƒ€ì…ë³„ ë¶„í¬
        - ë¶„ìì‹ ìë™ ê³„ì‚°
        
        **SMARTS ê²€ì¦:**
        - íŒ¨í„´ ë¬¸ë²• ì²´í¬
        - êµ¬ì¡° ì¼ì¹˜ í™•ì¸
        - ë¶€ë¶„ êµ¬ì¡° í•˜ì´ë¼ì´íŠ¸
        
        **íŒŒì¼ ê´€ë¦¬:**
        - JSON í˜•ì‹ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸°
        - êµ¬ì¡° ë°ì´í„° ë‚´ë³´ë‚´ê¸°
        - ì„¸ì…˜ ë°±ì—…/ë³µì›
        """)

    # ì—…ë°ì´íŠ¸ ì •ë³´
    st.markdown("---")
    st.subheader("ğŸ“ ìµœê·¼ ì—…ë°ì´íŠ¸")

    with st.expander("ë²„ì „ 2.0.0 - JavaScript ê¸°ë°˜ ë¦¬ë‰´ì–¼", expanded=True):
        st.markdown("""
        ### ğŸ†• ìƒˆë¡œìš´ ê¸°ëŠ¥
        - âœ… **JavaScript ê¸°ë°˜ ì¸í„°ë™í‹°ë¸Œ ìº”ë²„ìŠ¤**: ì‹¤ì‹œê°„ í¸ì§‘ ê°€ëŠ¥
        - âœ… **ë§ˆìš°ìŠ¤ í´ë¦­ ì¸í„°ë™ì…˜**: ì§ê´€ì ì¸ ë¶„ì ê·¸ë¦¬ê¸°
        - âœ… **ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°**: ë³€ê²½ì‚¬í•­ ì¦‰ì‹œ ë°˜ì˜
        - âœ… **í–¥ìƒëœ ì„±ëŠ¥**: ë¹ ë¥¸ ë Œë”ë§ê³¼ ë°˜ì‘ì„±
        - âœ… **ê²©ì ìŠ¤ëƒ… ê¸°ëŠ¥**: ì •í™•í•œ ì›ì ë°°ì¹˜
        - âœ… **ë‹¤ì–‘í•œ ê²°í•© íƒ€ì…**: ì‹œê°ì ìœ¼ë¡œ êµ¬ë¶„ë˜ëŠ” ê²°í•© í‘œí˜„
        
        ### ğŸ”§ ê°œì„ ì‚¬í•­
        - ë¶ˆí•„ìš”í•œ Plotly/Matplotlib ì˜ì¡´ì„± ì œê±°
        - ì½”ë“œ ìµœì í™” ë° ì •ë¦¬
        - ì„¸ì…˜ ìƒíƒœ ê´€ë¦¬ ê°œì„ 
        - ì˜¤ë¥˜ ì²˜ë¦¬ ê°•í™”
        """)

def create_help_page():
    """ë„ì›€ë§ í˜ì´ì§€"""
    st.title("â„¹ï¸ ë„ì›€ë§ - JavaScript ìº”ë²„ìŠ¤ ì‚¬ìš©ë²•")
    st.markdown("---")

    # JavaScript ìº”ë²„ìŠ¤ ì‚¬ìš©ë²• ì¤‘ì‹¬ìœ¼ë¡œ ì—…ë°ì´íŠ¸
    st.subheader("ğŸ–±ï¸ ì¸í„°ë™í‹°ë¸Œ ìº”ë²„ìŠ¤ ì‚¬ìš©ë²•")

    tab1, tab2, tab3, tab4 = st.tabs(["ê¸°ë³¸ ì¡°ì‘", "ê³ ê¸‰ ê¸°ëŠ¥", "ë‹¨ì¶•í‚¤", "ë¬¸ì œ í•´ê²°"])

    with tab1:
        st.markdown("""
        ### ğŸ”µ ì›ì ì¶”ê°€
        1. ìƒë‹¨ íˆ´ë°”ì—ì„œ **ğŸ”µ ì›ì** ë²„íŠ¼ í´ë¦­
        2. ì›í•˜ëŠ” ì›ì†Œ ë²„íŠ¼ í´ë¦­ (C, N, O, S, P)
        3. ìº”ë²„ìŠ¤ì—ì„œ ì›í•˜ëŠ” ìœ„ì¹˜ í´ë¦­
        4. ì›ìê°€ ìë™ìœ¼ë¡œ ê²©ìì— ë§ì¶° ë°°ì¹˜ë©ë‹ˆë‹¤
        
        ### ğŸ”— ê²°í•© ìƒì„±
        1. **ğŸ”— ê²°í•©** ë²„íŠ¼ í´ë¦­
        2. ê²°í•© íƒ€ì… ì„ íƒ (â€”, =, â‰¡, :)
        3. ì²« ë²ˆì§¸ ì›ì í´ë¦­ (ë¹¨ê°„ìƒ‰ìœ¼ë¡œ ì„ íƒë¨)
        4. ë‘ ë²ˆì§¸ ì›ì í´ë¦­
        5. ê²°í•©ì´ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤
        
        ### ğŸ‘† ì„ íƒ ë° ì´ë™
        1. **ğŸ‘† ì„ íƒ** ë²„íŠ¼ í´ë¦­
        2. ì›ìë¥¼ í´ë¦­í•˜ì—¬ ì„ íƒ
        3. ë“œë˜ê·¸í•˜ì—¬ ì´ë™ (ê°œë°œ ì˜ˆì •)
        
        ### ğŸ—‘ï¸ ì‚­ì œ
        1. **ğŸ—‘ï¸ ì‚­ì œ** ë²„íŠ¼ í´ë¦­
        2. ì‚­ì œí•  ì›ìë‚˜ ê²°í•© í´ë¦­
        3. ì—°ê²°ëœ ê²°í•©ë„ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤
        """)

    with tab2:
        st.markdown("""
        ### â¬Ÿ ë¯¸ë¦¬ ì •ì˜ëœ êµ¬ì¡°
        - **â¬Ÿ ë²¤ì  **: ë°©í–¥ì¡± 6ê° ê³ ë¦¬ ìë™ ìƒì„±
        - **â¬¡ ì‚¬ì´í´ë¡œí—¥ì‚°**: ì§€ë°©ì¡± 6ê° ê³ ë¦¬ ìë™ ìƒì„±
        - ì¤‘ì•™ ìœ„ì¹˜ (450, 300)ì— ë°°ì¹˜ë¨
        
        ### ğŸ¨ ì‹œê°ì  ê¸°ëŠ¥
        - **ê²©ì ë°°ê²½**: 50px ê°„ê²© ê²©ìë¡œ ì •í™•í•œ ë°°ì¹˜
        - **ì›ì†Œë³„ ìƒ‰ìƒ**: ê° ì›ì†Œë§ˆë‹¤ ê³ ìœ í•œ ìƒ‰ìƒ
        - **ê²°í•© ìŠ¤íƒ€ì¼**: 
          - ë‹¨ì¼: ì‹¤ì„  (â€”)
          - ì´ì¤‘: í‰í–‰ì„  (=)  
          - ì‚¼ì¤‘: 3ê°œ í‰í–‰ì„  (â‰¡)
          - ë°©í–¥ì¡±: ì ì„  (:)
        
        ### ğŸ“Š ì‹¤ì‹œê°„ ì •ë³´
        - í˜„ì¬ ëª¨ë“œ í‘œì‹œ
        - ì›ì/ê²°í•© ê°œìˆ˜ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
        - ì„ íƒëœ ì›ì í•˜ì´ë¼ì´íŠ¸
        """)

    with tab3:
        st.markdown("""
        ### âŒ¨ï¸ ë¹ ë¥¸ ì¡°ì‘ë²•
        
        **ì›ì†Œ ë¹ ë¥¸ ì„ íƒ:**
        - C, N, O, S, P ë²„íŠ¼ìœ¼ë¡œ ì›ì†Œ ë³€ê²½ê³¼ ë™ì‹œì— ì›ì ëª¨ë“œ í™œì„±í™”
        
        **ê²°í•© ë¹ ë¥¸ ìƒì„±:**
        - â€”, =, â‰¡, : ë²„íŠ¼ìœ¼ë¡œ ê²°í•© íƒ€ì… ë³€ê²½ê³¼ ë™ì‹œì— ê²°í•© ëª¨ë“œ í™œì„±í™”
        
        **ë¹ ë¥¸ ì´ˆê¸°í™”:**
        - **ğŸ—‘ï¸ ì „ì²´ì‚­ì œ** ë²„íŠ¼ìœ¼ë¡œ ëª¨ë“  ì›ìì™€ ê²°í•© ì‚­ì œ
        
        **êµ¬ì¡° ë¹ ë¥¸ ì¶”ê°€:**
        - **â¬Ÿ ë²¤ì  **, **â¬¡ ì‚¬ì´í´ë¡œí—¥ì‚°** ë²„íŠ¼ìœ¼ë¡œ ì¦‰ì‹œ êµ¬ì¡° ì¶”ê°€
        
        **ë°ì´í„° ê´€ë¦¬:**
        - **ğŸ’¾ ë‚´ë³´ë‚´ê¸°** ë²„íŠ¼ìœ¼ë¡œ ì½˜ì†”ì— JSON ë°ì´í„° ì¶œë ¥
        """)

    with tab4:
        st.markdown("""
        ### ğŸ”§ ì¼ë°˜ì ì¸ ë¬¸ì œë“¤

        **1. ìº”ë²„ìŠ¤ê°€ ë¡œë“œë˜ì§€ ì•Šì„ ë•Œ**
        - ë¸Œë¼ìš°ì € ìƒˆë¡œê³ ì¹¨ (F5)
        - ë‹¤ë¥¸ ë¸Œë¼ìš°ì €ì—ì„œ ì‹œë„
        - JavaScriptê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
        - ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ì˜¤ë¥˜ ë©”ì‹œì§€ í™•ì¸

        **2. ì›ìê°€ ì¶”ê°€ë˜ì§€ ì•Šì„ ë•Œ**
        - ì›ì ëª¨ë“œê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
        - ìº”ë²„ìŠ¤ ë‚´ë¶€ë¥¼ í´ë¦­í–ˆëŠ”ì§€ í™•ì¸
        - ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ì˜¤ë¥˜ ë©”ì‹œì§€ í™•ì¸

        **3. ê²°í•©ì´ ìƒì„±ë˜ì§€ ì•Šì„ ë•Œ**
        - ê²°í•© ëª¨ë“œê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
        - ë‘ ê°œì˜ ì„œë¡œ ë‹¤ë¥¸ ì›ìë¥¼ í´ë¦­í–ˆëŠ”ì§€ í™•ì¸
        - ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê²°í•©ì€ ì¤‘ë³µ ìƒì„±ë˜ì§€ ì•ŠìŒ

        **4. ë°ì´í„°ê°€ Streamlitì— ì „ë‹¬ë˜ì§€ ì•Šì„ ë•Œ**
        - ì„¸ì…˜ ìƒíƒœ í™•ì¸
        - í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ í›„ ì¬ì‹œë„
        - ë¶„ì ë°ì´í„° í‘œì‹œ ì²´í¬ë°•ìŠ¤ë¡œ ë°ì´í„° í™•ì¸

        **5. ì„±ëŠ¥ ë¬¸ì œ**
        - ë„ˆë¬´ ë§ì€ ì›ì (100ê°œ ì´ìƒ) ì‚¬ìš© ì‹œ ëŠë ¤ì§ˆ ìˆ˜ ìˆìŒ
        - ë¸Œë¼ìš°ì € íƒ­ì„ ë„ˆë¬´ ë§ì´ ì—´ì§€ ë§ ê²ƒ
        - í•„ìš” ì—†ëŠ” ë¶„ìëŠ” ì‚­ì œí•˜ì—¬ ì„±ëŠ¥ í–¥ìƒ
        """)

    # ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­
    st.markdown("---")
    st.subheader("ğŸ”¬ ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­")

    with st.expander("JavaScript ìº”ë²„ìŠ¤ ì•„í‚¤í…ì²˜", expanded=False):
        st.markdown("""
        ### êµ¬í˜„ ì„¸ë¶€ì‚¬í•­
        
        **ë Œë”ë§ ì—”ì§„:**
        - SVG ê¸°ë°˜ ë²¡í„° ê·¸ë˜í”½
        - ì‹¤ì‹œê°„ DOM ì¡°ì‘
        - ì´ë²¤íŠ¸ ê¸°ë°˜ ì¸í„°ë™ì…˜
        
        **ë°ì´í„° êµ¬ì¡°:**
        ```javascript
        atoms = [{
            id: 1,
            x: 450,
            y: 300,
            element: 'C'
        }]
        
        bonds = [{
            id: 1,
            atom1Id: 1,
            atom2Id: 2,
            type: 'single'
        }]
        ```
        
        **Streamlit í†µí•©:**
        - `streamlit.components.v1.html()` ì‚¬ìš©
        - `window.parent.postMessage()` ë¥¼ í†µí•œ ë°ì´í„° ì „ì†¡
        - ì„¸ì…˜ ìƒíƒœì™€ ì‹¤ì‹œê°„ ë™ê¸°í™”
        """)

def main():
    """ë©”ì¸ í•¨ìˆ˜"""
    # ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜
    page = create_sidebar()

    # í˜ì´ì§€ë³„ ë¼ìš°íŒ…
    if page == "ğŸ  í™ˆ":
        create_home_page()

    elif page == "âœï¸ ë¶„ì ê·¸ë¦¬ê¸°":
        st.title("âœï¸ ì¸í„°ë™í‹°ë¸Œ ë¶„ì ê·¸ë¦¬ê¸°")
        st.markdown("---")
        
        # JavaScript ê¸°ë°˜ ì¸í„°í˜ì´ìŠ¤ ì‚¬ìš©
        drawer = MoleculeDrawer()
        drawer.create_drawing_interface()

    elif page == "ğŸ§¬ SMARTS ìƒì„±":
        st.title("ğŸ§¬ SMARTS ìƒì„±")
        st.markdown("---")

        # í˜„ì¬ ë¶„ì ë¡œë“œ
        drawer = MoleculeDrawer()
        drawer.initialize_session_state()
        
        # ë¶„ì ë°ì´í„° í™•ì¸
        if not st.session_state.molecule_data['atoms']:
            st.warning("âš ï¸ ë¨¼ì € ë¶„ìë¥¼ ê·¸ë ¤ì£¼ì„¸ìš”!")
            st.info("**âœï¸ ë¶„ì ê·¸ë¦¬ê¸°** í˜ì´ì§€ì—ì„œ JavaScript ìº”ë²„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶„ìë¥¼ ê·¸ë¦° í›„ ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.")
            
            # ë¹ ë¥¸ ì‹œì‘ ë²„íŠ¼ë“¤
            st.markdown("### ğŸš€ ë¹ ë¥¸ ì‹œì‘")
            col1, col2, col3 = st.columns(3)
            
            with col1:
                if st.button("â¬Ÿ ë²¤ì  ìœ¼ë¡œ ì‹œì‘", type="primary"):
                    # ë²¤ì   êµ¬ì¡° ì§ì ‘ ì¶”ê°€
                    drawer.add_predefined_structure("c1ccccc1")
                    st.success("ë²¤ì   êµ¬ì¡°ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                    st.rerun()
            
            with col2:
                if st.button("ğŸ§ª ì—íƒ„ì˜¬ë¡œ ì‹œì‘"):
                    # ì—íƒ„ì˜¬ êµ¬ì¡° ì§ì ‘ ì¶”ê°€  
                    drawer.add_predefined_structure("CCO")
                    st.success("ì—íƒ„ì˜¬ êµ¬ì¡°ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                    st.rerun()
            
            with col3:
                if st.button("ğŸ’Š ì•„ìŠ¤í”¼ë¦°ìœ¼ë¡œ ì‹œì‘"):
                    # ì•„ìŠ¤í”¼ë¦° êµ¬ì¡° ì§ì ‘ ì¶”ê°€
                    drawer.add_predefined_structure("CC(=O)OC1=CC=CC=C1C(=O)O")
                    st.success("ì•„ìŠ¤í”¼ë¦° êµ¬ì¡°ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!")
                    st.rerun()
                    
        else:
            generator = SmartsGenerator()
            # ì„¸ì…˜ ìƒíƒœì˜ ë¶„ì ë°ì´í„°ë¥¼ ì§ì ‘ ì „ë‹¬
            smarts = generator.create_smarts_interface(st.session_state.molecule_data)

            # ìƒì„±ëœ SMARTSë¥¼ ì„¸ì…˜ì— ì €ì¥
            if smarts:
                st.session_state['selected_pattern'] = smarts

    elif page == "ğŸ” íŒ¨í„´ ë§¤ì¹­":
        st.title("ğŸ” íŒ¨í„´ ë§¤ì¹­")
        st.markdown("---")

        matcher = PatternMatcher()
        matcher.create_pattern_matching_interface()

    elif page == "ğŸ”„ ë°°ì¹˜ ë§¤ì¹­":
        st.title("ğŸ”„ ë°°ì¹˜ ë§¤ì¹­")
        st.markdown("---")

        matcher = PatternMatcher()
        matcher.create_batch_matching_interface()

    elif page == "ğŸ“š íŒ¨í„´ ë¼ì´ë¸ŒëŸ¬ë¦¬":
        st.title("ğŸ“š íŒ¨í„´ ë¼ì´ë¸ŒëŸ¬ë¦¬")
        st.markdown("---")

        generator = SmartsGenerator()
        generator.create_pattern_library_interface()

    elif page == "â„¹ï¸ ë„ì›€ë§":
        create_help_page()

    # í‘¸í„°
    st.markdown("---")
    st.markdown(
        """
        <div style='text-align: center; color: gray; padding: 20px;'>
            ğŸ§ª SMARTS íŒ¨í„´ í¸ì§‘ê¸° v2.0.0 | 
            JavaScript ê¸°ë°˜ ì¸í„°ë™í‹°ë¸Œ ìº”ë²„ìŠ¤ | 
            Made with â¤ï¸ using Streamlit & JavaScript
        </div>
        """,
        unsafe_allow_html=True
    )

if __name__ == "__main__":
    main()